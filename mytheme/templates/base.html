{% set current_lang = LANG or DEFAULT_LANG %}
<!DOCTYPE html>
<html lang="{% block html_lang %}{{ current_lang }}{% endblock html_lang %}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ SITENAME }}{% endblock title %}</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script src="{{ ROOT }}/theme/js/theme-toggle.js"></script>

    <link rel="stylesheet" href="{{ ROOT }}/theme/css/variables.css">
    <link rel="stylesheet" href="{{ ROOT }}/theme/css/theme.css">
    
    {% block head %}{% endblock head %}
</head>
<body>

    <div class="container">
        <header>
            <h1><a href="{{ SITEURL }}/" style="text-decoration:none; color: inherit;">{{ SITENAME }}</a></h1>
            <nav>
                <div class="nav-links">
                    <a href="{{ SITEURL }}/">{{ (TEXTS or {}).get(current_lang, {}).get('nav_posts', 'Posts') }}</a>

                    {% for p in pages %}
                        <a href="{{ SITEURL }}/{{ p.url }}">{{ p.title }}</a>
                    {% endfor %}
                </div>

                <div class="nav-controls">
                    <button type="button"
                            id="theme-toggle"
                            class="theme-toggle"
                            aria-pressed="false"
                            aria-label="Switch to dark mode">
                        Dark
                    </button>

                    <div class="language-switcher">
                        {% if page %}
                            <!-- For pages: show translations or fallback to language root -->
                            {% if page.translations %}
                                {% for translation in page.translations %}
                                    <a href="{{ SITEURL }}/{{ translation.url }}" hreflang="{{ translation.lang }}">{{ translation.lang|upper }}</a>
                                {% endfor %}
                            {% else %}
                                {% set switch_lang = 'en' if current_lang == 'tr' else 'tr' %}
                                <a href="{{ ROOT }}/{{ switch_lang }}/">{{ switch_lang|upper }}</a>
                            {% endif %}
                        {% elif article %}
                            <!-- For articles: show translations or fallback to language root -->
                            {% if article.translations %}
                                {% for translation in article.translations %}
                                    <a href="{{ SITEURL }}/{{ translation.url }}" hreflang="{{ translation.lang }}">{{ translation.lang|upper }}</a>
                                {% endfor %}
                            {% else %}
                                {% set switch_lang = 'en' if current_lang == 'tr' else 'tr' %}
                                <a href="{{ ROOT }}/{{ switch_lang }}/">{{ switch_lang|upper }}</a>
                            {% endif %}
                        {% else %}
                            <!-- For index: simple language switcher -->
                            {% set switch_lang = 'en' if current_lang == 'tr' else 'tr' %}
                            <a href="{{ ROOT }}/{{ switch_lang }}/">{{ switch_lang|upper }}</a>
                        {% endif %}
                    </div>
                </div>
            </nav>
        </header>

        <main>
            {% block content %}
            {% endblock content %}
        </main>
    </div>
</body>
</html>
